---
# tasks file for 07-join-master-nodes
#- name: Generated token - 1.
#  local_action: shell sed -n 73,75p ./token > ./mastertoken
#
#- name: Copy master token
#  copy:
#    src: /opt/k8s/mastertoken
#    dest: /tmp/join-command.sh
#    owner: root
#    group: root
#    mode: '0777'
#- name: Generated token - 2.
#  shell: sed -i 's/\b:80\b/& --apiserver-advertise-address {{ansible_eth1.ipv4.address}} /' /tmp/join-command.sh
#- name: Add new Kubernetes master member
#  command: sh /tmp/join-command.sh

- name: test2 "{{role_path }}"
  local_action: copy src="/tmp/join-command" dest="{{ role_path }}/my/join-command" mode=0777

#- name: Get the token for joining the nodes with Kuberentes master.
#  shell: kubeadm token create --print-join-command
#  register: kubernetes_join_command
#
#- debug:
#    msg: "{{ kubernetes_join_command.stdout }}"
#
#- name: Copy join command to local file.
#  become: false
#  any_errors_fatal: true
#  local_action: copy content="{{ kubernetes_join_command.stdout_lines[0] }}" dest="/tmp/kubernetes_join_command" mode=0777
